#Milestone_02_Final_Project

##Background

The purpose of this project is to analyze the temperature of Lake Michigan. The data analysis will focus on the comparison to the last full year (2023), but also analyze 2023 in relation to past years. Lastly, it will analyze Lake Michigan's temperature to the temperature of the other four Great Lakes. 

#Load Libraries
```{r}
library(tidyverse)
library(tidycensus)
library(rvest)
library(janitor)
library(dplyr)
library(readxl)
```

#Questions
1. In 2023, were there noticeable differences in the temperature of Lake Michigan compared to temperature differences in the other four great lakes?
2. What 5 days did Lake Michigan have the biggest drop in temperature in 2023? What 5 days did Lake Michigan have the biggest increase in temperature in 2023?
3.How have the average temperatures of Lake Michigan changed over the past five years, and are there regional weather patterns or recreational activities that could have impacted these changes?
4. How does 2023's average temperature in July compare to Lake Michigan's temperature in July in 2013, and 2003? 
5. How does Lake Michigan's temperature compare to the average trends in land temperature in Michigan throughout the 2023 year?

#Load Data from last 5 years
```{r}
data23 <- rio::import("temp2023.txt") %>% 
  clean_names() %>% 
  rename(year= "v1", day="v2", Sup.="v3", Mich.="v4", Huron="v5",Erie="v6", Ont.="v7",St.Clr="v8") %>% 
clean_names()

data22 <- rio::import("temp2022.txt") %>% 
  clean_names() %>% 
  rename(year= "v1", day="v2", Sup.="v3", Mich.="v4", Huron="v5",Erie="v6", Ont.="v7",St.Clr="v8")
# #RSW Comment - add a clean_names after this.
# %>% 
#   clean_names()

data21 <- rio::import("temp2021.txt") %>% 
  clean_names() %>% 
  rename(year= "v1", day="v2", Sup.="v3", Mich.="v4", Huron="v5",Erie="v6", Ont.="v7",St.Clr="v8")
# #RSW Comment - add a clean_names after this.
# %>% 
#   clean_names()

data20 <- rio::import("temp2020.txt") %>% 
  clean_names() %>% 
  rename(year= "v1", day="v2", Sup.="v3", Mich.="v4", Huron="v5",Erie="v6", Ont.="v7",St.Clr="v8")
# #RSW Comment - add a clean_names after this.
# %>% 
#   clean_names()
data19 <- rio::import("temp2019.txt") %>% 
  clean_names() %>% 
  rename(year= "v1", day="v2", Sup.="v3", Mich.="v4", Huron="v5",Erie="v6", Ont.="v7",St.Clr="v8")
# #RSW Comment - add a clean_names after this.
# %>% 
#   clean_names()
```

#Load Data from 2013 and 2003
```{r}
data13 <- rio::import("temp2013.txt") %>% 
  clean_names() %>% 
  rename(year= "v1", day="v2", Sup.="v3", Mich.="v4", Huron="v5",Erie="v6", Ont.="v7",St.Clr="v8")
# #RSW Comment - add a clean_names after this.
# %>% 
#   clean_names()

data03 <- rio::import("temp2003.txt") %>% 
  clean_names() %>% 
  rename(year= "v1", day="v2", Sup.="v3", Mich.="v4", Huron="v5",Erie="v6", Ont.="v7",St.Clr="v8")
# #RSW Comment - add a clean_names after this.
# %>% 
#   clean_names()

```
#Load Average Temperatures of 2023
```{r}
manis_temp <- read_excel("manis_temp.xltx")
```

#Question 1
In 2023, were there noticeable differences in the average temperature of Lake Michigan compared to temperature differences in the other four great lakes?
```{r}
#RSW comment - this failed because the column names are wrong and the means are not being returned into mich_avg

#Think about the steps in building a table just to have the average 2023 results. You will need to filter by the year you want and then average things out

mich_avg <- data23 
 mean(data23$Sup.)
 mean(data23$Mich.)
 mean(data23$Huron)
 mean(data23$Erie)
 mean(data23$Ont.)
 mean(data23$St.Clr)
 
 #>  mean(data23$Sup.)
# Warning: argument is not numeric or logical: returning NA[1] NA
# >  mean(data23$Mich.)
# Warning: argument is not numeric or logical: returning NA[1] NA
# >  mean(data23$Huron)
# Warning: argument is not numeric or logical: returning NA[1] NA
# >  mean(data23$Erie)
# Warning: argument is not numeric or logical: returning NA[1] NA
# >  mean(data23$Ont.)
# Warning: argument is not numeric or logical: returning NA[1] NA
# >  mean(data23$St.Clr)
# Warning: argument is not numeric or logical: returning NA[1] NA

#Mutate to own row 
 
mich_avg <- data23 %>% 
mutate(Sup. = mean(data23$Sup.), 
 Mich. = mean(data23$Mich.),
 Huron = mean(data23$Huron),
 Erie = mean(data23$Erie),
 Ont. =  mean(data23$Ont.),
St.Clr = mean(data23$St.Clr)) %>% 
  head(1) %>% 
  select(Sup., Mich., Huron, Erie, Ont., St.Clr)
```
#Observations
Lake Michigan was recorded on average lower temperatures (10.75 degrees celsius average ) than every lake except Lake Huron, which was recorded at a 9.97 degrees celsius average, and Lake Superior, at a 7.12 degrees celsius. Lake Superior is North of Lake Michigan, so expected to be at a cooler temperature. Lake Huron is North-East of Lake Michigan, and isn't as large, so most likely cools faster. 


#Question 2
What 5 days did Lake Michigan have the biggest drop in temperature in 2023? What 5 days did Lake Michigan have the biggest increase in temperature in 2023?
```{r}
mich_drop <- data23 %>% 
 select(year,day,mich)%>%
   arrange(desc(mich))%>%
  slice_head(n = 5)
```
#Professor Wells- I got this to run, but I can tell the answers that ran are not correct by looking at the data. On Tuesday, can we discuss what is wrong with this code?

#Question 3
